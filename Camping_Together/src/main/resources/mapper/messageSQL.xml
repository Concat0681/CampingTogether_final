<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="message">
    <insert id="insertMessage" parameterType="ms">
        INSERT INTO MESSAGE VALUES (MESSAGE_SEQ.NEXTVAL, #{receiver}, #{sender}, #{messageContent}, #{messageTitle},0 ,SYSDATE)
    </insert>
    
    <select id="selectMessagelist" parameterType="ms" resultType="ms">
        SELECT 
        	MESSAGE_NO as messageNo, 
        	RECEIVER, 
        	SENDER, 
        	MESSAGE_CONTENT as messageContent, 
        	MESSAGE_TITLE as messageTitle, 
        	READ_CHECK as readCheck, 
        	MESSAGE_DATE as messageDate
        FROM MESSAGE
        WHERE RECEIVER = #{receiver}
        ORDER BY MESSAGE_NO DESC
    </select>
    
    <select id="selectOneMessage" parameterType="ms" resultType="ms">
        SELECT 
        	MESSAGE_NO as messageNo, 
        	RECEIVER, 
        	SENDER, 
        	MESSAGE_CONTENT as messageContent, 
        	MESSAGE_TITLE as messageTitle, 
        	READ_CHECK as readCheck, 
        	MESSAGE_DATE as messageDate
        FROM MESSAGE
        WHERE MESSAGE_NO = #{messageNo}
    </select>
    
    <update id="updateMessageReadStatus" parameterType="ms">
		update message
		set read_check = 1
		where message_no = #{messageNo}
	</update>

	<select id="messageCount" parameterType="string" resultType="_int">
		select count(*)
		from message
		where receiver = #{memberId}
	</select>
</mapper>

